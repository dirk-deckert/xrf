\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amsmath}
\usepackage{xrf}
\usepackage{hyperref}

\title{xrf package documentation}
\author{Dirk - Andr\'e Deckert\\Pionus GmbH\\\texttt{deckert@pionus-solutions.de}}
\date{Version 1.0 (2026-02-17)}

\newcommand{\pkg}[1]{\textsf{#1}}
\newcommand{\cs}[1]{\texttt{\textbackslash#1}}
\hfuzz=2pt

\begin{document}
\maketitle

\section{Overview}
The \pkg{xrf} package provides cross-referencing helpers for constants, indexed remainders, and boxed term markers. Values are persisted in \texttt{\jobname.xrf} and resolved across LaTeX runs.

\section{How to Use}
\begin{itemize}
\item Compile at least twice so labels written to \texttt{.xrf} are available for references.
\item Keep labels unique per document (for example, avoid reusing the same label for different constants).
\item Commands with postfix \texttt{l} define a label; commands with postfix \texttt{r} reference a defined label.
\item Sequence commands (such as \cs{const}, \cs{remain}, \cs{term}) advance their counters each time they are used.
\item The \texttt{.xrf} file is generated automatically in the working directory and should not be edited manually.
\end{itemize}

\section{Main Commands}
This section documents the main commands of the package. Each example shows both source code and rendered output.

Naming convention: postfix \texttt{l} means \emph{label} (define and store), and postfix \texttt{r} means \emph{reference} (reuse a stored value).

\subsection*{\cs{const}}
Prints the next sequential constant (default format C with numeric index) and advances the constant counter.

Code:
\begin{verbatim}
\begin{align*}
\const
\const
\end{align*}
\end{verbatim}

Rendered output:
\begin{align*}
\const\\
\const
\end{align*}

\subsection*{\cs{constl\{label\}}}
Prints the next sequential constant, stores its index under \texttt{label}, and advances the counter.

Code:
\begin{verbatim}
\begin{equation*}
\constl{massdemo}
\end{equation*}
\end{verbatim}

Rendered output:
\begin{equation*}
\constl{massdemo}
\end{equation*}

\subsection*{\cs{constr\{label\}}}
Prints the constant associated with a previously stored label.

Code:
\begin{verbatim}
\begin{align*}
\constl{massref}
\constr{massref}
\end{align*}
\end{verbatim}

Rendered output:
\begin{align*}
\constl{massref}\\
\constr{massref}
\end{align*}

\subsection*{\cs{remain\{base\}}}
Prints the next indexed remainder using the provided base symbol and advances the remainder counter.

Code:
\begin{verbatim}
\begin{align*}
\remain{r}
\remain{r}
\end{align*}
\end{verbatim}

Rendered output:
\begin{align*}
\remain{r}\\
\remain{r}
\end{align*}

\subsection*{\cs{remainl\{base\}\{label\}}}
Prints the next indexed remainder with base symbol, stores its index under \texttt{label}, and advances the remainder counter.

Code:
\begin{verbatim}
\begin{equation*}
\remainl{r}{resdemo}
\end{equation*}
\end{verbatim}

Rendered output:
\begin{equation*}
\remainl{r}{resdemo}
\end{equation*}

\subsection*{\cs{remainr\{base\}\{label\}}}
Prints a remainder reference for \texttt{base} using the index stored under \texttt{label}.

Code:
\begin{verbatim}
\begin{align*}
\remainl{r}{resref}
\remainr{r}{resref}
\end{align*}
\end{verbatim}

Rendered output:
\begin{align*}
\remainl{r}{resref}\\
\remainr{r}{resref}
\end{align*}

\subsection*{\cs{term}}
Prints the next boxed term marker and advances the term counter.

Code:
\begin{verbatim}
\begin{align*}
\term
\term
\end{align*}
\end{verbatim}

Rendered output:
\begin{align*}
\term\\
\term
\end{align*}

\subsection*{\cs{terml\{label\}}}
Prints the next boxed term marker, stores its index under \texttt{label}, and advances the term counter.

Code:
\begin{verbatim}
\begin{equation*}
\terml{termdemo}
\end{equation*}
\end{verbatim}

Rendered output:
\begin{equation*}
\terml{termdemo}
\end{equation*}

\subsection*{\cs{termr\{label\}}}
Prints a boxed term reference using the index stored under \texttt{label}.

Code:
\begin{verbatim}
\begin{align*}
\terml{termref}
\termr{termref}
\end{align*}
\end{verbatim}

Rendered output:
\begin{align*}
\terml{termref}\\
\termr{termref}
\end{align*}

\section{Worked Example}
Code:
\begin{verbatim}
\documentclass{article}
\usepackage{amsmath}
\usepackage{xrf}
\begin{document}
Unknowns: x, y, z.
Named constants:
\namel{alpha}{\alpha}, \namel{beta}{\beta}, \namel{gamma}{\gamma}.
RHS constants:
\constl{c1}, \constl{c2}, \constl{c3}.

\begin{align}
\terml{t:eq1}\quad x + \namer{alpha}y
  + \namer{beta}z &= \constr{c1} \\
\terml{t:eq2}\quad y + \namer{gamma}z &= \constr{c2} \\
\terml{t:eq3}\quad z &= \constr{c3}
\end{align}

From \termr{t:eq3}: z = \constr{c3}.
From \termr{t:eq2}: y = \constr{c2}
  - \namer{gamma}\constr{c3}.
From \termr{t:eq1}: x = \constr{c1} - \namer{alpha}\constr{c2}
  + (\namer{alpha}\namer{gamma} - \namer{beta})\constr{c3}.
\end{document}
\end{verbatim}

Rendered output:
\begin{align*}
\terml{t:eq1-doc}\quad x + \namel{alpha-doc}{\alpha}y + \namel{beta-doc}{\beta}z &= \constl{c1-doc} \\
\terml{t:eq2-doc}\quad y + \namel{gamma-doc}{\gamma}z &= \constl{c2-doc} \\
\terml{t:eq3-doc}\quad z &= \constl{c3-doc}
\end{align*}

\begin{align*}
z &= \constr{c3-doc} \\
y &= \constr{c2-doc} - \namer{gamma-doc}\constr{c3-doc} \\
x &= \constr{c1-doc} - \namer{alpha-doc}\constr{c2-doc} + (\namer{alpha-doc}\namer{gamma-doc} - \namer{beta-doc})\constr{c3-doc}
\end{align*}

\section{Label Interface}
These commands are exposed for direct label/value control:
\begin{itemize}
\item \cs{labelname\{label\}\{value\}} stores an arbitrary value.
\item \cs{labelref\{label\}} retrieves the stored value.
\item \cs{namel\{label\}\{symbol\}} stores and prints a named symbol.
\item \cs{namer\{label\}} prints a named symbol.
\end{itemize}

\section{Customization API}
For users who need custom numbering families and renderers:
\begin{itemize}
\item \cs{xrfDeclareCounterSeries\{series\}} creates a numeric series counter.
\item \cs{xrfDeclareSeries\{series\}\{formatter\}} creates a series with custom rendering.
\item \cs{xrfSetSeries\{series\}\{n\}} sets the next index.
\item \cs{xrfItem\{series\}} prints the next formatted item.
\item \cs{xrfItemL\{series\}\{label\}} prints and labels a formatted item.
\item \cs{xrfItemR\{series\}\{label\}} references a formatted item by label.
\item \cs{xrfVarItem\{series\}\{base\}} prints a base-index item such as $r_n$.
\item \cs{xrfVarItemL} prints and labels a base-index item (arguments: series, base, label).
\item \cs{xrfVarItemR} references a base-index item by label (arguments: series, base, label).
\end{itemize}

Interplay summary:
\begin{verbatim}
\xrfDeclareSeries{axiom}{A_{#1}}
\xrfItemL{axiom}{ax:first}
\xrfItem{axiom}
\xrfItemR{axiom}{ax:first}
\end{verbatim}

Description:
\begin{itemize}
\item \cs{xrfDeclareSeries\{axiom\}\{A\_\{\#1\}\}} declares a series named \texttt{axiom} with formatter $A_n$.
\item \cs{xrfItemL\{axiom\}\{ax:first\}} prints the next item and stores its index under label \texttt{ax:first}.
\item \cs{xrfItem\{axiom\}} prints the next item in the same series.
\item \cs{xrfItemR\{axiom\}\{ax:first\}} prints the item referenced by \texttt{ax:first}.
\end{itemize}

Rendered output:
\begin{align*}
\xrfDeclareSeries{axiomdoc}{A_{#1}}\\
\xrfItemL{axiomdoc}{ax:first-doc}\\
\xrfItem{axiomdoc}\\
\xrfItemR{axiomdoc}{ax:first-doc}
\end{align*}

Compile at least twice to populate and consume \texttt{.xrf} label data.

\section{License}
Distributed under LPPL 1.3c or later.

\end{document}
